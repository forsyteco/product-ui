import{j as e,r as p}from"./iframe-CNYYlD36.js";import{c as j}from"./tailwind-CDN07tui.js";import{c as D}from"./createLucideIcon-DZo8MJhi.js";import{v as R}from"./popover-cC2mvnsT.js";import{t as te}from"./portal-_z1lZ7UR.js";import{I as se}from"./input-BJQufGgc.js";import{B as ne}from"./button-Bn0tC0DV.js";import{C as $}from"./checkbox-BtWd2eKC.js";import{I as O}from"./icon-button-dB5eXb_x.js";import{C as X}from"./chevron-right-BDkENKGb.js";import{S as F}from"./skeleton-BGw-DfA0.js";import{C as re}from"./chevron-left-JAPohfXr.js";const ae=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],le=D("arrow-down",ae);const oe=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ie=D("arrow-up-down",oe);const ce=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],de=D("arrow-up",ce);const ue=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],fe=D("funnel",ue);const pe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],he=D("search",pe),N={SELECTION:"selection",LINK:"link",NONE:"none",EXPANDABLE:"expandable"};function K({direction:t}){const s=t!==null;return e.jsxs("span",{className:j("inline-flex items-center justify-center rounded p-1",s&&"bg-accent"),children:[t==="asc"&&e.jsx(de,{className:"h-3 w-3 text-foreground"}),t==="desc"&&e.jsx(le,{className:"h-3 w-3 text-foreground"}),t===null&&e.jsx(ie,{className:"h-3 w-3 text-foreground opacity-50"})]})}K.__docgenInfo={description:"",methods:[],displayName:"SortIndicator"};function V(t){const s=t.replaceAll("_"," ");return s.charAt(0).toUpperCase()+s.slice(1).toLowerCase()}function z({columnId:t,filterValues:s,selectedValues:n,onFilterChange:r}){const[l,i]=p.useState(""),d=p.useMemo(()=>{if(!l)return s;const o=l.toLowerCase();return s.filter(h=>h.toLowerCase().includes(o)||V(h).toLowerCase().includes(o))},[s,l]),u=o=>{const h=n.includes(o)?n.filter(y=>y!==o):[...n,o];r(t,h)},c=()=>{r(t,[])},g=()=>{r(t,[...s])};return e.jsx("div",{className:"relative inline-block",children:e.jsxs(R,{children:[e.jsx(R.Button,{"aria-label":`Filter ${t}`,className:j("inline-flex items-center justify-center rounded p-1",n.length>0&&"bg-accent"),onClick:o=>o.stopPropagation(),children:e.jsx(fe,{className:"h-3 w-3 text-foreground"})}),e.jsx(te,{children:e.jsx(R.Panel,{anchor:{to:"bottom end",gap:8},className:"z-50 w-56 max-h-80 flex flex-col rounded-md bg-background shadow-lg ring-1 ring-border focus:outline-none",onClick:o=>o.stopPropagation(),children:e.jsxs("div",{className:"p-2 flex flex-col min-h-0 flex-1",children:[e.jsx("div",{className:"mb-2 flex-shrink-0",children:e.jsx(se,{type:"search",placeholder:"Search...",value:l,onChange:o=>i(o.target.value),autoFocus:!0,size:"sm",startElement:e.jsx(he,{className:"h-4 w-4"})})}),e.jsxs(ne,{variant:"ghost",size:"sm",onClick:n.length>0?c:g,className:"mb-2 flex-shrink-0 justify-center px-0 text-muted-foreground hover:text-foreground relative h-5 overflow-hidden",children:[e.jsx("span",{"aria-hidden":n.length>0,className:j("inline-block transition-all duration-200",n.length>0?"-translate-y-full opacity-0":"translate-y-0 opacity-100"),children:"Select all"}),e.jsx("span",{"aria-hidden":n.length===0,className:j("absolute inset-0 flex items-center justify-center transition-all duration-200",n.length>0?"translate-y-0 opacity-100":"translate-y-full opacity-0"),children:"Clear all"})]}),e.jsx("div",{"data-testid":"filter-options",className:"overflow-y-auto flex-1 min-h-0",children:d.map(o=>{const h=n.includes(o),y=V(o);return e.jsx("label",{className:"flex cursor-pointer items-center rounded px-2 py-1.5 hover:bg-muted",children:e.jsx($,{checked:h,onChange:()=>u(o),label:y})},o)})})]})})})]})})}z.__docgenInfo={description:"",methods:[],displayName:"FilterDropdown"};function U({columns:t,sortState:s,onSortChange:n,filterState:r=[],onFilterChange:l,rowInteraction:i,allRowIds:d,selectedRowIds:u=new Set,onSelectionChange:c}){const g=i===N.SELECTION,o=i===N.EXPANDABLE,h=d.length>0&&d.every(a=>u.has(a)),y=()=>{c&&c(h?new Set:new Set(d))},C=a=>{if(!a.sortable||!n)return;const b=s?.columnId===a.id?s.direction:null;let m;b===null?m="asc":b==="asc"?m="desc":m=null,n(m===null?null:{columnId:a.id,direction:m})},w=(a,b)=>{if(!l)return;const m=r.filter(A=>A.columnId!==a);b.length>0?l([...m,{columnId:a,values:b}]):l(m)},_=a=>r.find(m=>m.columnId===a)?.values||[],v=a=>{if(a.sortable)return s?.columnId===a.id?s.direction==="asc"?"ascending":"descending":"none"};return e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted border-b border-border",children:[o&&e.jsx("th",{className:"w-10 px-4 py-3","aria-label":"Expand"}),g&&e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx($,{checked:h,onChange:y,"aria-label":"Select all rows",className:"h-3 w-3"})}),t.map(a=>{const b=s?.columnId===a.id?s.direction:null;return e.jsx("th",{role:"columnheader","aria-sort":v(a),className:j("px-4 py-3 text-left font-semibold text-foreground",a.sortable&&"cursor-pointer select-none"),style:{width:a.width,minWidth:a.minWidth},onClick:()=>C(a),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:a.header}),a.sortable&&e.jsx(K,{direction:b}),a.filterable&&a.filterValues&&l&&e.jsx(z,{columnId:a.id,filterValues:a.filterValues,selectedValues:_(a.id),onFilterChange:w})]})},a.id)})]})})}U.__docgenInfo={description:"",methods:[],displayName:"TableHeader",props:{filterState:{defaultValue:{value:"[]",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1}}};function J({row:t,rowId:s,rowInteraction:n=N.NONE,isSelected:r=!1,onRowClick:l,onSelectionChange:i,children:d,isExpanded:u=!1,onExpandRow:c,expandedContentId:g}){const o=n===N.LINK,h=n===N.SELECTION,y=n===N.EXPANDABLE,C=()=>{o&&l&&l(t)},w=()=>{i&&i(s,!r)},_=v=>{v.stopPropagation(),c&&c(t,s)};return e.jsxs("tr",{role:"row",className:j("border-b border-border last:border-b-0 transition-colors duration-300",o&&"cursor-pointer hover:bg-muted/50",h&&"hover:bg-muted/30",r&&"bg-accent/10",u&&"border-b-0"),onClick:C,children:[y&&e.jsx("td",{className:"w-10 px-4 py-3",children:e.jsx(O,{icon:X,variant:"ghost",size:"small",onClick:_,"aria-expanded":u,"aria-controls":u?g:void 0,"aria-label":"Expand row",className:j("h-6 w-6 transition-colors duration-300 [&_svg]:transition-transform [&_svg]:duration-300",u&&"bg-accent hover:bg-accent [&_svg]:rotate-90")})}),h&&e.jsx("td",{className:"px-4 py-3",children:e.jsx($,{checked:r,onChange:w,onClick:v=>v.stopPropagation(),"aria-label":"Select row",className:"h-3 w-3"})}),d]})}J.__docgenInfo={description:"",methods:[],displayName:"TableRow",props:{rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},isSelected:{defaultValue:{value:"false",computed:!1},required:!1},isExpanded:{defaultValue:{value:"false",computed:!1},required:!1}}};function G({column:t,row:s,value:n}){const r={left:"text-left",center:"text-center",right:"text-right"}[t.align||"left"],l=t.cell;return e.jsx("td",{role:"gridcell",className:j("px-4 py-3",r),style:{width:t.width,minWidth:t.minWidth},children:l?e.jsx(l,{value:n,row:s}):String(n??"")})}G.__docgenInfo={description:"",methods:[],displayName:"TableCell"};function Q({columns:t,rowInteraction:s}){return e.jsxs("tr",{className:"border-b border-border last:border-b-0",children:[s===N.EXPANDABLE&&e.jsx("td",{className:"w-10 px-4 py-3",children:e.jsx(F,{className:"h-4 w-4"})}),s===N.SELECTION&&e.jsx("td",{className:"px-4 py-3",children:e.jsx(F,{className:"h-4 w-4"})}),t.map(n=>e.jsx("td",{className:"px-4 py-3",style:{width:n.width,minWidth:n.minWidth},children:e.jsx(F,{className:"h-4 w-full"})},n.id))]})}Q.__docgenInfo={description:"",methods:[],displayName:"SkeletonRow"};function Y({children:t,colSpan:s}){return e.jsx("tr",{children:e.jsx("td",{colSpan:s,className:"px-4 py-12 text-center text-muted-foreground",children:t||"No data available"})})}Y.__docgenInfo={description:"",methods:[],displayName:"EmptyState"};function B({id:t,colSpan:s,children:n,isCollapsing:r=!1}){const[l,i]=p.useState(!1),[d,u]=p.useState(0),c=p.useRef(null);return p.useEffect(()=>{if(r)i(!1),u(0);else{const g=requestAnimationFrame(()=>{i(!0),c.current&&u(c.current.scrollHeight)});return()=>cancelAnimationFrame(g)}},[r]),p.useEffect(()=>{c.current&&l&&!r&&u(c.current.scrollHeight)},[n,l,r]),e.jsx("tr",{role:"row",id:t,className:"border-b border-border",children:e.jsx("td",{colSpan:s,role:"gridcell",className:"border-t border-border bg-muted/20 p-0 overflow-hidden",children:e.jsx("div",{className:j("transition-all duration-300 ease-in-out overflow-hidden",l?"opacity-100":"opacity-0"),style:{maxHeight:l?`${d}px`:"0px"},children:e.jsx("div",{ref:c,className:"px-4 py-4",children:n})})})})}B.__docgenInfo={description:"",methods:[],displayName:"ExpandedRow",props:{isCollapsing:{defaultValue:{value:"false",computed:!1},required:!1}}};function Z({columns:t,data:s,getRowId:n,loading:r=!1,emptyState:l,rowInteraction:i=N.NONE,selectedRowIds:d=new Set,onRowClick:u,onRowSelectionChange:c,pageSize:g,expandedRowId:o,expandedData:h,isLoadingExpanded:y=!1,onExpandRow:C,expandedRowContent:w}){const _=i===N.SELECTION,v=i===N.EXPANDABLE,a=t.length+(_?1:0)+(v?1:0),[b,m]=p.useState(null),[A,I]=p.useState(null),E=p.useRef(null);return p.useEffect(()=>{if(E.current&&E.current!==o){const x=s.find(f=>n(f)===E.current);if(x){m(E.current),I(x);const f=setTimeout(()=>{m(null),I(null)},300);return()=>clearTimeout(f)}}E.current=o??null},[o,s,n]),r?e.jsx("tbody",{children:Array.from({length:Math.min(g,5)},(x,f)=>`skeleton-row-${f}`).map(x=>e.jsx(Q,{columns:t,rowInteraction:i},x))}):s.length===0?e.jsx("tbody",{children:e.jsx(Y,{colSpan:a,children:l})}):e.jsx("tbody",{children:s.map(x=>{const f=n(x),P=o===f,S=`expanded-content-${f}`;return e.jsxs(p.Fragment,{children:[e.jsx(J,{row:x,rowId:f,rowInteraction:i,isSelected:d.has(f),onRowClick:u,onSelectionChange:c,isExpanded:P,onExpandRow:C,expandedContentId:S,children:t.map(k=>{const L=(()=>{if(k.accessorFn)return k.accessorFn(x);if(k.accessorKey)return x[k.accessorKey]})();return e.jsx(G,{column:k,row:x,value:L},k.id)})}),P&&w&&e.jsx(B,{id:S,colSpan:a,children:e.jsx(w,{row:x,rowId:f,data:h??null,loading:y})}),b===f&&A&&w&&e.jsx(B,{id:`expanded-content-${f}-collapsing`,colSpan:a,isCollapsing:!0,children:e.jsx(w,{row:A,rowId:f,data:null,loading:!1})})]},f)})})}Z.__docgenInfo={description:"",methods:[],displayName:"TableBody",props:{loading:{defaultValue:{value:"false",computed:!1},required:!1},rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1},isLoadingExpanded:{defaultValue:{value:"false",computed:!1},required:!1}}};function ee({page:t,pageSize:s,totalCount:n,onPageChange:r,className:l}){const i=Math.max(1,Math.ceil(n/s)),d=t<=1,u=t>=i;return e.jsxs("nav",{role:"navigation","aria-label":"Pagination",className:j("flex items-center justify-between px-4 py-3",l),children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",i]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{icon:re,variant:"ghost",size:"small",onClick:()=>r(t-1),disabled:d,"aria-label":"Previous page"}),e.jsx(O,{icon:X,variant:"ghost",size:"small",onClick:()=>r(t+1),disabled:u,"aria-label":"Next page"})]})]})}ee.__docgenInfo={description:"",methods:[],displayName:"Pagination"};function me({columns:t,data:s,getRowId:n,rowInteraction:r=N.NONE,onRowClick:l,selectedRowIds:i=new Set,onSelectionChange:d,expandedRowContent:u,getExpandedRowData:c,page:g,pageSize:o,totalCount:h,onPageChange:y,sortState:C,onSortChange:w,filterState:_=[],onFilterChange:v,loading:a=!1,emptyState:b,className:m}){const A=p.useMemo(()=>s.map(n),[s,n]),[I,E]=p.useState(null),[x,f]=p.useState(null),[P,S]=p.useState(!1),k=p.useCallback(async(L,T)=>{if(I===T){E(null),f(null),S(!1);return}if(E(T),f(null),S(!0),c)try{const q=await c(L,T);E(W=>(W===T&&(f(q),S(!1)),W))}catch{S(!1)}else S(!1)},[I,c]),H=(L,T)=>{if(!d)return;const q=new Set(i);T?q.add(L):q.delete(L),d(q)};return e.jsxs("div",{className:j("overflow-hidden rounded-lg border border-border",m),children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{"aria-busy":a,className:"w-full border-collapse text-sm",children:[e.jsx(U,{columns:t,sortState:C,onSortChange:w,filterState:_,onFilterChange:v,rowInteraction:r,allRowIds:A,selectedRowIds:i,onSelectionChange:d}),e.jsx(Z,{columns:t,data:s,getRowId:n,loading:a,emptyState:b,rowInteraction:r,selectedRowIds:i,onRowClick:l,onRowSelectionChange:H,pageSize:o,expandedRowId:I,expandedData:x,isLoadingExpanded:P,onExpandRow:k,expandedRowContent:u})]})}),e.jsx(ee,{page:g,pageSize:o,totalCount:h,onPageChange:y,className:"border-t border-border"})]})}me.__docgenInfo={description:"",methods:[],displayName:"DataTable",props:{rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1},filterState:{defaultValue:{value:"[]",computed:!1},required:!1},loading:{defaultValue:{value:"false",computed:!1},required:!1}}};function M(t){return t==null?"":typeof t=="string"?t:typeof t=="number"||typeof t=="boolean"||typeof t=="bigint"?String(t):JSON.stringify(t)}function xe(t,s,n){if(t==null&&s==null)return 0;if(t==null)return n==="asc"?1:-1;if(s==null)return n==="asc"?-1:1;let r=0;return typeof t=="string"&&typeof s=="string"?r=t.localeCompare(s):typeof t=="number"&&typeof s=="number"?r=t-s:r=M(t).localeCompare(M(s)),n==="asc"?r:-r}function ge(t,s){return!s||s.length===0?t:t.filter(n=>s.every(r=>{if(r.values.length===0)return!0;const l=M(n[r.columnId]);return r.values.includes(l)}))}function be(t,s){if(!s)return t;const{columnId:n,direction:r}=s;return[...t].sort((l,i)=>xe(l[n],i[n],r))}function Le({data:t,page:s,pageSize:n,sortState:r,filterState:l}){let i=ge(t,l??[]);i=be(i,r??null);const d=i.length,u=Math.ceil(d/n),c=(s-1)*n;return{data:i.slice(c,c+n),totalCount:d,page:s,pageSize:n,totalPages:u}}export{me as D,N as R,Le as q};
