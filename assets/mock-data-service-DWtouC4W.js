import{j as e,r as x}from"./iframe-BZ1wujjQ.js";import{c as j}from"./tailwind-CDN07tui.js";import{c as F}from"./createLucideIcon-Bk6cezq3.js";import{v as P}from"./popover-B58FQ6jG.js";import{t as ae}from"./portal-EQenjn8w.js";import{I as le}from"./input-rz79fwGt.js";import{B as z}from"./button-LJhTR5u8.js";import{C as W}from"./checkbox-Bp9mjbJH.js";import{I as M}from"./icon-button-B65-RB3u.js";import{C as U}from"./chevron-right-DMQxt9C_.js";import{S as O}from"./skeleton-BXYFGocm.js";import{C as oe}from"./chevron-left-Ezh5pr5F.js";const ie=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],ce=F("arrow-down",ie);const de=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ue=F("arrow-up-down",de);const fe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],he=F("arrow-up",fe);const pe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],me=F("funnel",pe);const xe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ge=F("search",xe),be={headerBackground:"#000000",headerText:"#ffffff",headerIconActiveBackground:"#ffde13",headerIconActiveForeground:"#000000",rowBackground:"#ffffff",selectedRowBackground:"#fef9c3",borderColor:"#cbd5e1",paginationBackground:"#ffffff",paginationText:"#000000"},S={SELECTION:"selection",LINK:"link",NONE:"none",EXPANDABLE:"expandable"};function G({direction:t,color:r,activeBackground:n,activeForeground:s}){const o=t!==null,a=o?s??r:r,i=a?{color:a}:void 0,f=o&&n?{backgroundColor:n}:void 0;return e.jsxs("span",{className:j("inline-flex items-center justify-center rounded p-1",o&&!n&&"bg-accent"),style:f,children:[t==="asc"&&e.jsx(he,{className:j("h-3 w-3",!a&&"text-foreground"),style:i}),t==="desc"&&e.jsx(ce,{className:j("h-3 w-3",!a&&"text-foreground"),style:i}),t===null&&e.jsx(ue,{className:j("h-3 w-3",!a&&"opacity-50 text-foreground"),style:i})]})}G.__docgenInfo={description:"",methods:[],displayName:"SortIndicator"};function K(t){const r=t.replaceAll("_"," ");return r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()}function J({columnId:t,filterValues:r,selectedValues:n,onFilterChange:s,showSelectAll:o=!0,iconColor:a,activeBackground:i,activeForeground:f}){const[c,u]=x.useState(""),h=x.useMemo(()=>{if(!c)return r;const d=c.toLowerCase();return r.filter(g=>g.toLowerCase().includes(d)||K(g).toLowerCase().includes(d))},[r,c]),_=d=>{const g=n.includes(d)?n.filter(y=>y!==d):[...n,d];s(t,g)},w=()=>{s(t,[])},C=()=>{s(t,[...r])},v=n.length>0,E=v?f??a:a,I=v&&i?{backgroundColor:i}:void 0;return e.jsx("div",{className:"relative inline-block",children:e.jsxs(P,{children:[e.jsx(P.Button,{"aria-label":`Filter ${t}`,className:j("inline-flex items-center justify-center rounded p-1",v&&!i&&"bg-accent"),style:I,onClick:d=>d.stopPropagation(),children:e.jsx(me,{className:j("h-3 w-3",!E&&"text-foreground"),style:E?{color:E}:void 0})}),e.jsx(ae,{children:e.jsx(P.Panel,{anchor:{to:"bottom end",gap:8},className:"z-50 w-56 max-h-80 flex flex-col rounded-md bg-background shadow-lg ring-1 ring-border focus:outline-none",onClick:d=>d.stopPropagation(),children:e.jsxs("div",{className:"p-2 flex flex-col min-h-0 flex-1",children:[e.jsx("div",{className:"mb-2 flex-shrink-0",children:e.jsx(le,{type:"search",placeholder:"Search...",value:c,onChange:d=>u(d.target.value),autoFocus:!0,size:"sm",startElement:e.jsx(ge,{className:"h-4 w-4"})})}),o?e.jsxs(z,{variant:"ghost",size:"sm",onClick:n.length>0?w:C,className:"mb-2 flex-shrink-0 justify-center px-0 text-muted-foreground hover:text-foreground relative h-5 overflow-hidden",children:[e.jsx("span",{"aria-hidden":n.length>0,className:j("inline-block transition-all duration-200",n.length>0?"-translate-y-full opacity-0":"translate-y-0 opacity-100"),children:"Select all"}),e.jsx("span",{"aria-hidden":n.length===0,className:j("absolute inset-0 flex items-center justify-center transition-all duration-200",n.length>0?"translate-y-0 opacity-100":"translate-y-full opacity-0"),children:"Clear all"})]}):e.jsx(z,{variant:"ghost",size:"sm",onClick:w,disabled:n.length===0,className:"mb-2 flex-shrink-0 justify-center px-0 text-muted-foreground hover:text-foreground h-5",children:"Clear all"}),e.jsx("div",{"data-testid":"filter-options",className:"overflow-y-auto flex-1 min-h-0",children:h.map(d=>{const g=n.includes(d),y=K(d);return e.jsx("label",{className:"flex cursor-pointer items-center rounded px-2 py-1.5 hover:bg-muted",children:e.jsx(W,{checked:g,onChange:()=>_(d),label:y,checkedBackground:i,checkedForeground:f})},d)})})]})})})]})})}J.__docgenInfo={description:"",methods:[],displayName:"FilterDropdown",props:{showSelectAll:{defaultValue:{value:"true",computed:!1},required:!1}}};function Q({columns:t,sortState:r,onSortChange:n,filterState:s=[],onFilterChange:o,rowInteraction:a,allRowIds:i,selectedRowIds:f=new Set,onSelectionChange:c,colorConfig:u}){const h=a===S.SELECTION,_=a===S.EXPANDABLE,w=i.length>0&&i.every(l=>f.has(l)),C=()=>{c&&c(w?new Set:new Set(i))},v=l=>{if(!l.sortable||!n)return;const p=r?.columnId===l.id?r.direction:null;let N;p===null?N="asc":p==="asc"?N="desc":N=null,n(N===null?null:{columnId:l.id,direction:N})},E=(l,p)=>{if(!o)return;const N=s.filter(A=>A.columnId!==l);p.length>0?o([...N,{columnId:l,values:p}]):o(N)},I=l=>s.find(N=>N.columnId===l)?.values||[],d=l=>{if(l.sortable)return r?.columnId===l.id?r.direction==="asc"?"ascending":"descending":"none"},g=u?.headerBackground?{backgroundColor:u.headerBackground}:void 0,y=u?.headerText?{color:u.headerText}:void 0;return e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted border-b border-border",style:g,children:[_&&e.jsx("th",{className:"w-10 px-4 py-3","aria-label":"Expand",style:y}),h&&e.jsx("th",{className:"px-4 py-3 text-left",style:y,children:e.jsx(W,{checked:w,onChange:C,"aria-label":"Select all rows",className:"h-3 w-3",checkedBackground:u?.headerIconActiveBackground,checkedForeground:u?.headerIconActiveForeground})}),t.map(l=>{const p=r?.columnId===l.id?r.direction:null;return e.jsx("th",{role:"columnheader","aria-sort":d(l),className:j("px-4 py-3 text-left font-semibold text-foreground",l.sortable&&"cursor-pointer select-none"),style:{width:l.width,minWidth:l.minWidth,...y},onClick:()=>v(l),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.header}),l.sortable&&e.jsx(G,{direction:p,color:u?.headerText,activeBackground:u?.headerIconActiveBackground,activeForeground:u?.headerIconActiveForeground}),l.filterable&&l.filterValues&&o&&e.jsx(J,{columnId:l.id,filterValues:l.filterValues,selectedValues:I(l.id),onFilterChange:E,showSelectAll:l.filterSelectAll!==!1,iconColor:u?.headerText,activeBackground:u?.headerIconActiveBackground,activeForeground:u?.headerIconActiveForeground})]})},l.id)})]})})}Q.__docgenInfo={description:"",methods:[],displayName:"TableHeader",props:{filterState:{defaultValue:{value:"[]",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1}}};function Y({row:t,rowId:r,rowInteraction:n=S.NONE,isSelected:s=!1,onRowClick:o,onSelectionChange:a,children:i,isExpanded:f=!1,onExpandRow:c,expandedContentId:u,colorConfig:h}){const _=n===S.LINK,w=n===S.SELECTION,C=n===S.EXPANDABLE,v=()=>{_&&o&&o(t)},E=()=>{a&&a(r,!s)},I=y=>{y.stopPropagation(),c&&c(t,r)},d=()=>{if(s&&h?.selectedRowBackground)return h.selectedRowBackground;if(h?.rowBackground)return h.rowBackground},g=d()?{backgroundColor:d()}:void 0;return e.jsxs("tr",{role:"row",className:j("border-b border-border last:border-b-0 transition-colors duration-300",_&&"cursor-pointer hover:bg-muted/50",w&&"hover:bg-muted/30",s&&!h?.selectedRowBackground&&"bg-accent/10",f&&"border-b-0"),style:g,onClick:v,children:[C&&e.jsx("td",{className:"w-10 px-4 py-3",children:e.jsx(M,{icon:U,variant:"ghost",size:"small",onClick:I,"aria-expanded":f,"aria-controls":f?u:void 0,"aria-label":"Expand row",className:j("h-6 w-6 transition-colors duration-300 [&_svg]:transition-transform [&_svg]:duration-300",f&&"bg-accent hover:bg-accent [&_svg]:rotate-90")})}),w&&e.jsx("td",{className:"px-4 py-3",children:e.jsx(W,{checked:s,onChange:E,onClick:y=>y.stopPropagation(),"aria-label":"Select row",className:"h-3 w-3",checkedBackground:h?.headerIconActiveBackground,checkedForeground:h?.headerIconActiveForeground})}),i]})}Y.__docgenInfo={description:"",methods:[],displayName:"TableRow",props:{rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},isSelected:{defaultValue:{value:"false",computed:!1},required:!1},isExpanded:{defaultValue:{value:"false",computed:!1},required:!1}}};function Z({column:t,row:r,value:n}){const s={left:"text-left",center:"text-center",right:"text-right"}[t.align||"left"],o=t.cell;return e.jsx("td",{role:"gridcell",className:j("px-4 py-3",s),style:{width:t.width,minWidth:t.minWidth},children:o?e.jsx(o,{value:n,row:r}):String(n??"")})}Z.__docgenInfo={description:"",methods:[],displayName:"TableCell"};function ee({columns:t,rowInteraction:r}){return e.jsxs("tr",{className:"border-b border-border last:border-b-0",children:[r===S.EXPANDABLE&&e.jsx("td",{className:"w-10 px-4 py-3",children:e.jsx(O,{className:"h-4 w-4"})}),r===S.SELECTION&&e.jsx("td",{className:"px-4 py-3",children:e.jsx(O,{className:"h-4 w-4"})}),t.map(n=>e.jsx("td",{className:"px-4 py-3",style:{width:n.width,minWidth:n.minWidth},children:e.jsx(O,{className:"h-4 w-full"})},n.id))]})}ee.__docgenInfo={description:"",methods:[],displayName:"SkeletonRow"};function te({children:t,colSpan:r}){return e.jsx("tr",{children:e.jsx("td",{colSpan:r,className:"px-4 py-12 text-center text-muted-foreground",children:t||"No data available"})})}te.__docgenInfo={description:"",methods:[],displayName:"EmptyState"};function $({id:t,colSpan:r,children:n,isCollapsing:s=!1}){const[o,a]=x.useState(!1),[i,f]=x.useState(0),c=x.useRef(null);return x.useEffect(()=>{if(s)a(!1),f(0);else{const u=requestAnimationFrame(()=>{a(!0),c.current&&f(c.current.scrollHeight)});return()=>cancelAnimationFrame(u)}},[s]),x.useEffect(()=>{c.current&&o&&!s&&f(c.current.scrollHeight)},[n,o,s]),e.jsx("tr",{role:"row",id:t,className:"border-b border-border",children:e.jsx("td",{colSpan:r,role:"gridcell",className:"border-t border-border bg-muted/20 p-0 overflow-hidden",children:e.jsx("div",{className:j("transition-all duration-300 ease-in-out overflow-hidden",o?"opacity-100":"opacity-0"),style:{maxHeight:o?`${i}px`:"0px"},children:e.jsx("div",{ref:c,className:"px-4 py-4",children:n})})})})}$.__docgenInfo={description:"",methods:[],displayName:"ExpandedRow",props:{isCollapsing:{defaultValue:{value:"false",computed:!1},required:!1}}};function re({columns:t,data:r,getRowId:n,loading:s=!1,emptyState:o,rowInteraction:a=S.NONE,selectedRowIds:i=new Set,onRowClick:f,onRowSelectionChange:c,pageSize:u,expandedRowId:h,expandedData:_,isLoadingExpanded:w=!1,onExpandRow:C,expandedRowContent:v,colorConfig:E}){const I=a===S.SELECTION,d=a===S.EXPANDABLE,g=t.length+(I?1:0)+(d?1:0),[y,l]=x.useState(null),[p,N]=x.useState(null),A=x.useRef(null);return x.useEffect(()=>{if(A.current&&A.current!==h){const b=r.find(m=>n(m)===A.current);if(b){l(A.current),N(b);const m=setTimeout(()=>{l(null),N(null)},300);return()=>clearTimeout(m)}}A.current=h??null},[h,r,n]),s?e.jsx("tbody",{children:Array.from({length:Math.min(u,5)},(b,m)=>`skeleton-row-${m}`).map(b=>e.jsx(ee,{columns:t,rowInteraction:a},b))}):r.length===0?e.jsx("tbody",{children:e.jsx(te,{colSpan:g,children:o})}):e.jsx("tbody",{children:r.map(b=>{const m=n(b),T=h===m,q=`expanded-content-${m}`;return e.jsxs(x.Fragment,{children:[e.jsx(Y,{row:b,rowId:m,rowInteraction:a,isSelected:i.has(m),onRowClick:f,onSelectionChange:c,isExpanded:T,onExpandRow:C,expandedContentId:q,colorConfig:E,children:t.map(k=>{const R=(()=>{if(k.accessorFn)return k.accessorFn(b);if(k.accessorKey)return b[k.accessorKey]})();return e.jsx(Z,{column:k,row:b,value:R},k.id)})}),T&&v&&e.jsx($,{id:q,colSpan:g,children:e.jsx(v,{row:b,rowId:m,data:_??null,loading:w})}),y===m&&p&&v&&e.jsx($,{id:`expanded-content-${m}-collapsing`,colSpan:g,isCollapsing:!0,children:e.jsx(v,{row:p,rowId:m,data:null,loading:!1})})]},m)})})}re.__docgenInfo={description:"",methods:[],displayName:"TableBody",props:{loading:{defaultValue:{value:"false",computed:!1},required:!1},rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1},isLoadingExpanded:{defaultValue:{value:"false",computed:!1},required:!1}}};function ne({page:t,pageSize:r,totalCount:n,onPageChange:s,className:o,colorConfig:a}){const i=Math.max(1,Math.ceil(n/r)),f=t<=1,c=t>=i,u={...a?.paginationBackground&&{backgroundColor:a.paginationBackground},...a?.paginationText&&{color:a.paginationText}};return e.jsxs("nav",{role:"navigation","aria-label":"Pagination",className:j("flex items-center justify-between px-4 py-3",o),style:Object.keys(u).length>0?u:void 0,children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",i]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{icon:oe,variant:"ghost",size:"small",onClick:()=>s(t-1),disabled:f,"aria-label":"Previous page"}),e.jsx(M,{icon:U,variant:"ghost",size:"small",onClick:()=>s(t+1),disabled:c,"aria-label":"Next page"})]})]})}ne.__docgenInfo={description:"",methods:[],displayName:"Pagination"};function ye({columns:t,data:r,getRowId:n,rowInteraction:s=S.NONE,onRowClick:o,selectedRowIds:a=new Set,onSelectionChange:i,expandedRowContent:f,getExpandedRowData:c,page:u,pageSize:h,totalCount:_,onPageChange:w,sortState:C,onSortChange:v,filterState:E=[],onFilterChange:I,loading:d=!1,emptyState:g,className:y,colorConfig:l}){const p={...be,...l},N=x.useMemo(()=>r.map(n),[r,n]),[A,b]=x.useState(null),[m,T]=x.useState(null),[q,k]=x.useState(!1),V=x.useCallback(async(D,B)=>{if(A===B){b(null),T(null),k(!1);return}if(b(B),T(null),k(!0),c)try{const L=await c(D,B);b(X=>(X===B&&(T(L),k(!1)),X))}catch{k(!1)}else k(!1)},[A,c]),R=(D,B)=>{if(!i)return;const L=new Set(a);B?L.add(D):L.delete(D),i(L)},se=p?.borderColor?{borderColor:p.borderColor}:void 0;return e.jsxs("div",{className:j("overflow-hidden rounded-lg border border-border",y),style:se,children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{"aria-busy":d,className:"w-full border-collapse text-sm",children:[e.jsx(Q,{columns:t,sortState:C,onSortChange:v,filterState:E,onFilterChange:I,rowInteraction:s,allRowIds:N,selectedRowIds:a,onSelectionChange:i,colorConfig:p}),e.jsx(re,{columns:t,data:r,getRowId:n,loading:d,emptyState:g,rowInteraction:s,selectedRowIds:a,onRowClick:o,onRowSelectionChange:R,pageSize:h,expandedRowId:A,expandedData:m,isLoadingExpanded:q,onExpandRow:V,expandedRowContent:f,colorConfig:p})]})}),e.jsx(ne,{page:u,pageSize:h,totalCount:_,onPageChange:w,className:"border-t border-border",colorConfig:p})]})}ye.__docgenInfo={description:"",methods:[],displayName:"DataTable",props:{rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1},filterState:{defaultValue:{value:"[]",computed:!1},required:!1},loading:{defaultValue:{value:"false",computed:!1},required:!1}}};function H(t){return t==null?"":typeof t=="string"?t:typeof t=="number"||typeof t=="boolean"||typeof t=="bigint"?String(t):JSON.stringify(t)}function Ne(t,r,n){if(t==null&&r==null)return 0;if(t==null)return n==="asc"?1:-1;if(r==null)return n==="asc"?-1:1;let s=0;return typeof t=="string"&&typeof r=="string"?s=t.localeCompare(r):typeof t=="number"&&typeof r=="number"?s=t-r:s=H(t).localeCompare(H(r)),n==="asc"?s:-s}function je(t,r){return!r||r.length===0?t:t.filter(n=>r.every(s=>{if(s.values.length===0)return!0;const o=H(n[s.columnId]);return s.values.includes(o)}))}function ve(t,r){if(!r)return t;const{columnId:n,direction:s}=r;return[...t].sort((o,a)=>Ne(o[n],a[n],s))}function qe({data:t,page:r,pageSize:n,sortState:s,filterState:o}){let a=je(t,o??[]);a=ve(a,s??null);const i=a.length,f=Math.ceil(i/n),c=(r-1)*n;return{data:a.slice(c,c+n),totalCount:i,page:r,pageSize:n,totalPages:f}}export{ye as D,S as R,qe as q};
