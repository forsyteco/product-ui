import{j as e,r as p}from"./iframe-CeVB8obd.js";import{c as N}from"./tailwind-CDN07tui.js";import{c as D}from"./createLucideIcon-BwIkv3qW.js";import{v as M}from"./popover-D9koPpvg.js";import{t as ae}from"./portal-1sZo8vyw.js";import{I as le}from"./input-OJTsGN7_.js";import{B as z}from"./button-GPmkhAQI.js";import{C as V}from"./checkbox-2-jZNadh.js";import{I as H}from"./icon-button-BSr_cQob.js";import{C as U}from"./chevron-right-DdBM03iq.js";import{S as $}from"./skeleton-_9uoEcU1.js";import{C as oe}from"./chevron-left-B4nSeWsa.js";const ie=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],de=D("arrow-down",ie);const ce=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ue=D("arrow-up-down",ce);const fe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],he=D("arrow-up",fe);const pe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],me=D("funnel",pe);const xe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ge=D("search",xe),be={headerBackground:"#000000",headerText:"#ffffff",headerIconActiveBackground:"#ffde13",headerIconActiveForeground:"#000000",rowBackground:"#ffffff",selectedRowBackground:"#fef9c3",borderColor:"#cbd5e1",paginationBackground:"#ffffff",paginationText:"#000000"},k={SELECTION:"selection",LINK:"link",NONE:"none",EXPANDABLE:"expandable"};function G({direction:t,color:r,activeBackground:n,activeForeground:s}){const o=t!==null,a=o?s??r:r,i=a?{color:a}:void 0,f=o&&n?{backgroundColor:n}:void 0;return e.jsxs("span",{className:N("inline-flex items-center justify-center rounded p-1",o&&!n&&"bg-accent"),style:f,children:[t==="asc"&&e.jsx(he,{className:N("h-3 w-3",!a&&"text-foreground"),style:i}),t==="desc"&&e.jsx(de,{className:N("h-3 w-3",!a&&"text-foreground"),style:i}),t===null&&e.jsx(ue,{className:N("h-3 w-3",!a&&"opacity-50 text-foreground"),style:i})]})}G.__docgenInfo={description:"",methods:[],displayName:"SortIndicator"};function K(t){const r=t.replaceAll("_"," ");return r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()}function J({columnId:t,filterValues:r,selectedValues:n,onFilterChange:s,showSelectAll:o=!0,iconColor:a,activeBackground:i,activeForeground:f}){const[d,u]=p.useState(""),h=p.useMemo(()=>{if(!d)return r;const c=d.toLowerCase();return r.filter(g=>g.toLowerCase().includes(c)||K(g).toLowerCase().includes(c))},[r,d]),j=c=>{const g=n.includes(c)?n.filter(m=>m!==c):[...n,c];s(t,g)},v=()=>{s(t,[])},I=()=>{s(t,[...r])},w=n.length>0,S=w?f??a:a,C=w&&i?{backgroundColor:i}:void 0;return e.jsx("div",{className:"relative inline-block",children:e.jsxs(M,{children:[e.jsx(M.Button,{"aria-label":`Filter ${t}`,className:N("inline-flex items-center justify-center rounded p-1",w&&!i&&"bg-accent"),style:C,onClick:c=>c.stopPropagation(),children:e.jsx(me,{className:N("h-3 w-3",!S&&"text-foreground"),style:S?{color:S}:void 0})}),e.jsx(ae,{children:e.jsx(M.Panel,{anchor:{to:"bottom end",gap:8},className:"z-50 w-56 max-h-80 flex flex-col rounded-md bg-background shadow-lg ring-1 ring-border focus:outline-none",onClick:c=>c.stopPropagation(),children:e.jsxs("div",{className:"p-2 flex flex-col min-h-0 flex-1",children:[e.jsx("div",{className:"mb-2 flex-shrink-0",children:e.jsx(le,{type:"search",placeholder:"Search...",value:d,onChange:c=>u(c.target.value),autoFocus:!0,size:"sm",startElement:e.jsx(ge,{className:"h-4 w-4"})})}),o?e.jsxs(z,{variant:"ghost",size:"sm",onClick:n.length>0?v:I,className:"mb-2 flex-shrink-0 justify-center px-0 text-muted-foreground hover:text-foreground relative h-5 overflow-hidden",children:[e.jsx("span",{"aria-hidden":n.length>0,className:N("inline-block transition-all duration-200",n.length>0?"-translate-y-full opacity-0":"translate-y-0 opacity-100"),children:"Select all"}),e.jsx("span",{"aria-hidden":n.length===0,className:N("absolute inset-0 flex items-center justify-center transition-all duration-200",n.length>0?"translate-y-0 opacity-100":"translate-y-full opacity-0"),children:"Clear all"})]}):e.jsx(z,{variant:"ghost",size:"sm",onClick:v,disabled:n.length===0,className:"mb-2 flex-shrink-0 justify-center px-0 text-muted-foreground hover:text-foreground h-5",children:"Clear all"}),e.jsx("div",{"data-testid":"filter-options",className:"overflow-y-auto flex-1 min-h-0",children:h.map(c=>{const g=n.includes(c),m=K(c);return e.jsx("label",{className:"flex cursor-pointer items-center rounded px-2 py-1.5 hover:bg-muted",children:e.jsx(V,{checked:g,onChange:()=>j(c),label:m,checkedBackground:i,checkedForeground:f})},c)})})]})})})]})})}J.__docgenInfo={description:"",methods:[],displayName:"FilterDropdown",props:{showSelectAll:{defaultValue:{value:"true",computed:!1},required:!1}}};function Q({columns:t,sortState:r,onSortChange:n,filterState:s=[],onFilterChange:o,rowInteraction:a,allRowIds:i,selectedRowIds:f=new Set,onSelectionChange:d,colorConfig:u}){const h=a===k.SELECTION,j=a===k.EXPANDABLE,v=i.length>0&&i.every(l=>f.has(l)),I=()=>{d&&d(v?new Set:new Set(i))},w=l=>{if(!l.sortable||!n)return;const x=r?.columnId===l.id?r.direction:null;let b;x===null?b="asc":x==="asc"?b="desc":b=null,n(b===null?null:{columnId:l.id,direction:b})},S=(l,x)=>{if(!o)return;const b=s.filter(_=>_.columnId!==l);x.length>0?o([...b,{columnId:l,values:x}]):o(b)},C=l=>s.find(b=>b.columnId===l)?.values||[],c=l=>{if(l.sortable)return r?.columnId===l.id?r.direction==="asc"?"ascending":"descending":"none"},g=u?.headerBackground?{backgroundColor:u.headerBackground}:void 0,m=u?.headerText?{color:u.headerText}:void 0;return e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted border-b border-border",style:g,children:[j&&e.jsx("th",{className:"w-10 px-4 py-3","aria-label":"Expand",style:m}),h&&e.jsx("th",{className:"px-4 py-3 text-left",style:m,children:e.jsx(V,{checked:v,onChange:I,"aria-label":"Select all rows",className:"h-3 w-3",checkedBackground:u?.headerIconActiveBackground,checkedForeground:u?.headerIconActiveForeground})}),t.map(l=>{const x=r?.columnId===l.id?r.direction:null;return e.jsx("th",{role:"columnheader","aria-sort":c(l),className:N("px-4 py-3 text-left font-semibold text-foreground",l.sortable&&"cursor-pointer select-none"),style:{width:l.width,minWidth:l.minWidth,...m},onClick:()=>w(l),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.header}),l.sortable&&e.jsx(G,{direction:x,color:u?.headerText,activeBackground:u?.headerIconActiveBackground,activeForeground:u?.headerIconActiveForeground}),l.filterable&&l.filterValues&&o&&e.jsx(J,{columnId:l.id,filterValues:l.filterValues,selectedValues:C(l.id),onFilterChange:S,showSelectAll:l.filterSelectAll!==!1,iconColor:u?.headerText,activeBackground:u?.headerIconActiveBackground,activeForeground:u?.headerIconActiveForeground})]})},l.id)})]})})}Q.__docgenInfo={description:"",methods:[],displayName:"TableHeader",props:{filterState:{defaultValue:{value:"[]",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1}}};function Y({row:t,rowId:r,rowInteraction:n=k.NONE,isSelected:s=!1,onRowClick:o,onSelectionChange:a,children:i,isExpanded:f=!1,onExpandRow:d,expandedContentId:u,colorConfig:h}){const j=n===k.LINK,v=n===k.SELECTION,I=n===k.EXPANDABLE,w=()=>{j&&o&&o(t)},S=()=>{a&&a(r,!s)},C=m=>{m.stopPropagation(),d&&d(t,r)},c=()=>{if(s&&h?.selectedRowBackground)return h.selectedRowBackground;if(h?.rowBackground)return h.rowBackground},g=c()?{backgroundColor:c()}:void 0;return e.jsxs("tr",{role:"row",className:N("border-b border-border last:border-b-0 transition-colors duration-300",j&&"cursor-pointer hover:bg-muted/50",v&&"hover:bg-muted/30",s&&!h?.selectedRowBackground&&"bg-accent/10",f&&"border-b-0"),style:g,onClick:w,children:[I&&e.jsx("td",{className:"w-10 px-4 py-3",children:e.jsx(H,{icon:U,variant:"ghost",size:"small",onClick:C,"aria-expanded":f,"aria-controls":f?u:void 0,"aria-label":"Expand row",className:N("h-6 w-6 transition-colors duration-300 [&_svg]:transition-transform [&_svg]:duration-300",f&&"bg-accent hover:bg-accent [&_svg]:rotate-90")})}),v&&e.jsx("td",{className:"px-4 py-3",children:e.jsx(V,{checked:s,onChange:S,onClick:m=>m.stopPropagation(),"aria-label":"Select row",className:"h-3 w-3",checkedBackground:h?.headerIconActiveBackground,checkedForeground:h?.headerIconActiveForeground})}),i]})}Y.__docgenInfo={description:"",methods:[],displayName:"TableRow",props:{rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},isSelected:{defaultValue:{value:"false",computed:!1},required:!1},isExpanded:{defaultValue:{value:"false",computed:!1},required:!1}}};function Z({column:t,row:r,value:n}){const s={left:"text-left",center:"text-center",right:"text-right"}[t.align||"left"],o=t.cell;return e.jsx("td",{role:"gridcell",className:N("px-4 py-3",s),style:{width:t.width,minWidth:t.minWidth},children:o?e.jsx(o,{value:n,row:r}):String(n??"")})}Z.__docgenInfo={description:"",methods:[],displayName:"TableCell"};function ee({columns:t,rowInteraction:r}){return e.jsxs("tr",{className:"border-b border-border last:border-b-0",children:[r===k.EXPANDABLE&&e.jsx("td",{className:"w-10 px-4 py-3",children:e.jsx($,{className:"h-4 w-4"})}),r===k.SELECTION&&e.jsx("td",{className:"px-4 py-3",children:e.jsx($,{className:"h-4 w-4"})}),t.map(n=>e.jsx("td",{className:"px-4 py-3",style:{width:n.width,minWidth:n.minWidth},children:e.jsx($,{className:"h-4 w-full"})},n.id))]})}ee.__docgenInfo={description:"",methods:[],displayName:"SkeletonRow"};function te({children:t,colSpan:r}){return e.jsx("tr",{children:e.jsx("td",{colSpan:r,className:"px-4 py-12 text-center text-muted-foreground",children:t||"No data available"})})}te.__docgenInfo={description:"",methods:[],displayName:"EmptyState"};function re({id:t,colSpan:r,children:n,isCollapsing:s=!1}){const[o,a]=p.useState(!1),[i,f]=p.useState(0),d=p.useRef(null);return p.useEffect(()=>{if(s)a(!1),f(0);else{const u=requestAnimationFrame(()=>{a(!0),d.current&&f(d.current.scrollHeight)});return()=>cancelAnimationFrame(u)}},[s]),p.useEffect(()=>{d.current&&o&&!s&&f(d.current.scrollHeight)},[n,o,s]),e.jsx("tr",{role:"row",id:t,className:"border-b border-border",children:e.jsx("td",{colSpan:r,role:"gridcell",className:"border-t border-border bg-muted/20 p-0 overflow-hidden",children:e.jsx("div",{className:N("transition-all duration-300 ease-in-out overflow-hidden",o?"opacity-100":"opacity-0"),style:{maxHeight:o?`${i}px`:"0px"},children:e.jsx("div",{ref:d,className:"px-4 py-4",children:n})})})})}re.__docgenInfo={description:"",methods:[],displayName:"ExpandedRow",props:{isCollapsing:{defaultValue:{value:"false",computed:!1},required:!1}}};function ne({columns:t,data:r,getRowId:n,loading:s=!1,emptyState:o,rowInteraction:a=k.NONE,selectedRowIds:i=new Set,onRowClick:f,onRowSelectionChange:d,pageSize:u,expandedRowId:h,expandedData:j,isLoadingExpanded:v=!1,onExpandRow:I,expandedRowContent:w,colorConfig:S}){const C=a===k.SELECTION,c=a===k.EXPANDABLE,g=t.length+(C?1:0)+(c?1:0),[m,l]=p.useState(null),[x,b]=p.useState(null),[_,L]=p.useState(null),R=p.useRef(null);return j!=null&&(R.current=j),h!==_&&(L(h??null),_&&(l(_),b(R.current),R.current=null)),p.useEffect(()=>{if(m){const y=setTimeout(()=>{l(null),b(null)},300);return()=>clearTimeout(y)}},[m]),s?e.jsx("tbody",{children:Array.from({length:Math.min(u,5)},(y,E)=>`skeleton-row-${E}`).map(y=>e.jsx(ee,{columns:t,rowInteraction:a},y))}):r.length===0?e.jsx("tbody",{children:e.jsx(te,{colSpan:g,children:o})}):e.jsx("tbody",{children:r.map(y=>{const E=n(y),A=h===E,P=m===E,O=`expanded-content-${E}`;return e.jsxs(p.Fragment,{children:[e.jsx(Y,{row:y,rowId:E,rowInteraction:a,isSelected:i.has(E),onRowClick:f,onSelectionChange:d,isExpanded:A,onExpandRow:I,expandedContentId:O,colorConfig:S,children:t.map(T=>{const B=(()=>{if(T.accessorFn)return T.accessorFn(y);if(T.accessorKey)return y[T.accessorKey]})();return e.jsx(Z,{column:T,row:y,value:B},T.id)})}),(A||P)&&w&&e.jsx(re,{id:O,colSpan:g,isCollapsing:P&&!A,children:e.jsx(w,{row:y,rowId:E,data:A?j??null:x??null,loading:A?v:!1})})]},E)})})}ne.__docgenInfo={description:"",methods:[],displayName:"TableBody",props:{loading:{defaultValue:{value:"false",computed:!1},required:!1},rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1},isLoadingExpanded:{defaultValue:{value:"false",computed:!1},required:!1}}};function se({page:t,pageSize:r,totalCount:n,onPageChange:s,className:o,colorConfig:a}){const i=Math.max(1,Math.ceil(n/r)),f=t<=1,d=t>=i,u={...a?.paginationBackground&&{backgroundColor:a.paginationBackground},...a?.paginationText&&{color:a.paginationText}};return e.jsxs("nav",{role:"navigation","aria-label":"Pagination",className:N("flex items-center justify-between px-4 py-3",o),style:Object.keys(u).length>0?u:void 0,children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",i]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{icon:oe,variant:"ghost",size:"small",onClick:()=>s(t-1),disabled:f,"aria-label":"Previous page"}),e.jsx(H,{icon:U,variant:"ghost",size:"small",onClick:()=>s(t+1),disabled:d,"aria-label":"Next page"})]})]})}se.__docgenInfo={description:"",methods:[],displayName:"Pagination"};function ye({columns:t,data:r,getRowId:n,rowInteraction:s=k.NONE,onRowClick:o,selectedRowIds:a=new Set,onSelectionChange:i,expandedRowContent:f,getExpandedRowData:d,page:u,pageSize:h,totalCount:j,onPageChange:v,sortState:I,onSortChange:w,filterState:S=[],onFilterChange:C,loading:c=!1,emptyState:g,className:m,colorConfig:l}){const x={...be,...l},b=p.useMemo(()=>r.map(n),[r,n]),[_,L]=p.useState(null),[R,y]=p.useState(null),[E,A]=p.useState(!1),P=p.useCallback(async(F,B)=>{if(_===B){L(null),y(null),A(!1);return}if(L(B),y(null),A(!0),d)try{const q=await d(F,B);L(X=>(X===B&&(y(q),A(!1)),X))}catch{A(!1)}else A(!1)},[_,d]),O=(F,B)=>{if(!i)return;const q=new Set(a);B?q.add(F):q.delete(F),i(q)},T=x?.borderColor?{borderColor:x.borderColor}:void 0;return e.jsxs("div",{className:N("overflow-hidden rounded-lg border border-border",m),style:T,children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{"aria-busy":c,className:"w-full border-collapse text-sm",children:[e.jsx(Q,{columns:t,sortState:I,onSortChange:w,filterState:S,onFilterChange:C,rowInteraction:s,allRowIds:b,selectedRowIds:a,onSelectionChange:i,colorConfig:x}),e.jsx(ne,{columns:t,data:r,getRowId:n,loading:c,emptyState:g,rowInteraction:s,selectedRowIds:a,onRowClick:o,onRowSelectionChange:O,pageSize:h,expandedRowId:_,expandedData:R,isLoadingExpanded:E,onExpandRow:P,expandedRowContent:f,colorConfig:x})]})}),e.jsx(se,{page:u,pageSize:h,totalCount:j,onPageChange:v,className:"border-t border-border",colorConfig:x})]})}ye.__docgenInfo={description:"",methods:[],displayName:"DataTable",props:{rowInteraction:{defaultValue:{value:"'none'",computed:!1},required:!1},selectedRowIds:{defaultValue:{value:"new Set()",computed:!1},required:!1},filterState:{defaultValue:{value:"[]",computed:!1},required:!1},loading:{defaultValue:{value:"false",computed:!1},required:!1}}};function W(t){return t==null?"":typeof t=="string"?t:typeof t=="number"||typeof t=="boolean"||typeof t=="bigint"?String(t):JSON.stringify(t)}function Ne(t,r,n){if(t==null&&r==null)return 0;if(t==null)return n==="asc"?1:-1;if(r==null)return n==="asc"?-1:1;let s=0;return typeof t=="string"&&typeof r=="string"?s=t.localeCompare(r):typeof t=="number"&&typeof r=="number"?s=t-r:s=W(t).localeCompare(W(r)),n==="asc"?s:-s}function je(t,r){return!r||r.length===0?t:t.filter(n=>r.every(s=>{if(s.values.length===0)return!0;const o=W(n[s.columnId]);return s.values.includes(o)}))}function ve(t,r){if(!r)return t;const{columnId:n,direction:s}=r;return[...t].sort((o,a)=>Ne(o[n],a[n],s))}function Fe({data:t,page:r,pageSize:n,sortState:s,filterState:o}){let a=je(t,o??[]);a=ve(a,s??null);const i=a.length,f=Math.ceil(i/n),d=(r-1)*n;return{data:a.slice(d,d+n),totalCount:i,page:r,pageSize:n,totalPages:f}}export{ye as D,k as R,Fe as q};
